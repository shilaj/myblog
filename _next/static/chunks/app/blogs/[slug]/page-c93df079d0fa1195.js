(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[688,338],{6670:function(e,t,s){Promise.resolve().then(s.bind(s,1255)),Promise.resolve().then(s.t.bind(s,2972,23))},1255:function(e,t,s){"use strict";s.d(t,{default:function(){return c}});var a=s(7437),r=s(2265),n=s(738),o=s(2148),i=s(5978);let l={apiKey:"AIzaSyAnYqWEZPTBZeYZhDpUFxbAKGWbcffdn2k",authDomain:"myblog-fb0a6.firebaseapp.com",projectId:"myblog-fb0a6",appId:"1:69520263430:web:3d22d5d9a1ab79dfe83687",storageBucket:"myblog-fb0a6.firebasestorage.app",messagingSenderId:"69520263430"},d=Object.values(l).every(Boolean);function c(e){var t;let{threadId:s,title:c="Comments"}=e,u=(0,r.useMemo)(()=>d?(0,n.C6)().length?(0,n.Mq)():(0,n.ZF)(l):null,[]),h=u?(0,o.v0)(u):null,m=u?(0,i.ad)(u):null,[p,x]=(0,r.useState)(null),[b,f]=(0,r.useState)(""),[g,y]=(0,r.useState)([]),[v,w]=(0,r.useState)(!1),[N,j]=(0,r.useState)(!1),[A,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(h)return(0,o.Aj)(h,e=>x(e))},[h]),(0,r.useEffect)(()=>{h&&(0,o.cx)(h).catch(e=>{S(_(e)),console.error(e)})},[h]),(0,r.useEffect)(()=>{if(!m)return;let e=(0,i.IO)((0,i.hJ)(m,"comments"),(0,i.ar)("threadId","==",s),(0,i.Xo)("createdAt","asc"));return(0,i.cf)(e,e=>{y(e.docs.map(e=>({id:e.id,...e.data()})))})},[m,s]);let k=async e=>{if(h){S(null),j(!1);try{let t="google"===e?new o.hJ:new o._O;await (0,o.rh)(h,t)}catch(t){if("auth/popup-blocked"===t.code||"auth/operation-not-supported-in-this-environment"===t.code){j(!0);try{let t="google"===e?new o.hJ:new o._O;await (0,o.F6)(h,t);return}catch(e){console.error(e),S(_(e)),j(!1);return}}S(_(t)),console.error(t)}}},P=async()=>{if(m&&p&&b.trim()){w(!0),S(null);try{var e,t;await (0,i.ET)((0,i.hJ)(m,"comments"),{threadId:s,message:b.trim(),createdAt:(0,i.Bt)(),displayName:null!==(e=p.displayName)&&void 0!==e?e:"Anonymous",photoURL:null!==(t=p.photoURL)&&void 0!==t?t:void 0,uid:p.uid}),f("")}catch(e){S("Unable to post your comment. Please retry."),console.error(e)}finally{w(!1)}}},E=async()=>{h&&await (0,o.w7)(h)};function _(e){switch(e.code){case"auth/unauthorized-domain":return"Add this domain to Firebase Authentication → Settings → Authorized domains.";case"auth/account-exists-with-different-credential":return"You already used a different provider for this email. Sign in with that provider first.";case"auth/network-request-failed":return"Network error – check your connection and try again.";case"auth/popup-closed-by-user":return"Popup closed before finishing sign-in. Please try again.";case"auth/cancelled-popup-request":return"Another sign-in request is already running. Please wait or refresh.";default:return"Authentication failed. Please try again or review your Firebase provider setup."}}return d?(0,a.jsxs)("section",{className:"mt-12 rounded-2xl border border-white/10 bg-white/5 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:c}),(0,a.jsx)("p",{className:"text-sm text-slate-400",children:"Google sign-in required to participate."})]}),p&&(0,a.jsx)("button",{type:"button",onClick:E,className:"text-xs uppercase tracking-widest text-slate-400 hover:text-white",children:"Sign out"})]}),!p&&(0,a.jsx)("div",{className:"mt-4 flex flex-wrap gap-3",children:(0,a.jsx)("button",{type:"button",onClick:()=>k("google"),className:"rounded-full border border-white/20 px-4 py-2 text-sm text-white transition hover:border-white/40",disabled:N,children:N?"Redirecting…":"Continue with Google"})}),p&&(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-3 text-sm text-slate-300",children:[p.photoURL&&(0,a.jsx)("img",{src:p.photoURL,alt:"Avatar",className:"h-8 w-8 rounded-full"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-white",children:null!==(t=p.displayName)&&void 0!==t?t:"Anonymous"}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Share what resonated with you."})]})]}),p&&(0,a.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,a.jsx)("textarea",{value:b,onChange:e=>f(e.target.value),rows:3,placeholder:"Your thoughts…",className:"w-full rounded-2xl border border-white/20 bg-slate-900/40 p-4 text-sm text-white placeholder:text-slate-500 focus:border-cyan-300 focus:outline-none"}),(0,a.jsx)("button",{type:"button",disabled:v||!b.trim(),onClick:P,className:"rounded-full border border-cyan-400 px-4 py-2 text-sm text-cyan-200 transition hover:bg-cyan-400/10 disabled:cursor-not-allowed disabled:opacity-50",children:v?"Posting…":"Post comment"})]}),A&&(0,a.jsx)("p",{className:"mt-3 text-sm text-rose-300",children:A}),(0,a.jsxs)("ul",{className:"mt-6 space-y-4",children:[g.map(e=>{var t,s,r,n;return(0,a.jsxs)("li",{className:"rounded-2xl border border-white/10 bg-slate-900/30 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm text-slate-400",children:[e.photoURL&&(0,a.jsx)("img",{src:e.photoURL,alt:null!==(s=e.displayName)&&void 0!==s?s:"Avatar",className:"h-8 w-8 rounded-full"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-white",children:null!==(r=e.displayName)&&void 0!==r?r:"Anonymous"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:null!==(n=null===(t=e.createdAt)||void 0===t?void 0:t.toDate().toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}))&&void 0!==n?n:"Just now"})]})]}),(0,a.jsx)("p",{className:"mt-3 text-sm text-slate-200",children:e.message})]},e.id)}),0===g.length&&(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"No comments yet — be the first!"})]})]}):(0,a.jsxs)("section",{className:"mt-12 rounded-2xl border border-amber-500/40 bg-amber-500/5 p-6 text-sm text-amber-200",children:["Provide Firebase credentials via NEXT_PUBLIC_FIREBASE_* env vars to enable ",c,"."]})}}},function(e){e.O(0,[609,324,972,351,971,117,744],function(){return e(e.s=6670)}),_N_E=e.O()}]);